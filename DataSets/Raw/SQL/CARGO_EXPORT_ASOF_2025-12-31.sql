-- CARGO_EXPORT_ASOF_2024-12-31.sql
SELECT *
FROM TBL_CARGO c
WHERE c."VOYAGE_ID" IN (
  SELECT v."VOYAGE_ID"
  FROM TBL_VOYAGE v
  WHERE v."ESTIMATED_VOYAGE_START_DATE" IS NOT NULL
    AND v."ESTIMATED_VOYAGE_START_DATE" <= TO_TIMESTAMP('31.12.2025 23:59:59','DD.MM.YYYY HH24:MI:SS')
    AND v."DAYS_TOTAL" IS NOT NULL
    AND v."ESTIMATED_VOYAGE_START_DATE" + NUMTODSINTERVAL(v."DAYS_TOTAL"*24,'HOUR')
        <= TO_TIMESTAMP('31.12.2025 23:59:59','DD.MM.YYYY HH24:MI:SS')
)
ORDER BY c."VOYAGE_ID", c."CARGO_ID";
