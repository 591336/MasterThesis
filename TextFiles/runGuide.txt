Run Guide - MasterThesis project

Environment setup
  1. Install uv (macOS via Homebrew, Windows via winget `Astral.Uv`).
  2. Create or refresh the local env with `uv sync --locked` (append `--group dev` / `--group ml` as needed).
  3. Interpreter selection:
     - macOS/Linux: pick `./.venv/bin/python` in VS Code or source `.venv/bin/activate`.
     - Windows: pick `./.venv/Scripts/python.exe` in VS Code or run `.venv\Scripts\Activate.ps1`.

Port turnaround dataset pipeline
  - Command: `uv run python Models/build_port_turnaround_dataset.py [--customer stena]`
    - Outputs: `DataSets/Derived/NorthernLights/port_turnaround_training.csv` by default, or `DataSets/Derived/Stena/port_turnaround_training.csv` when `--customer stena` is supplied. Parquet is written when an engine is installed.
    - Notes: Script emits QA counts at the end and warns if parquet export is skipped (install `pyarrow` or `fastparquet`). Omit `--customer` to default to Northern Lights.

Port turnaround lookup generation
  - Prerequisite: Latest `port_turnaround_training.csv` from the step above.
  - Command: `uv run python Models/port_turnaround_lookup.py [--customer stena]`
    - Outputs: `DataSets/Derived/NorthernLights/port_turnaround_lookup.csv` (default) or `DataSets/Derived/Stena/port_turnaround_lookup.csv` when `--customer stena`; parquet written when supported.

QA artefacts for thesis figures
  - Command: `uv run python QA/port_turnaround_dataset_qa.py [--customer stena]`
    - Outputs:
      * Northern Lights: `DataSets/Derived/NorthernLights/QA/...`; Stena: `DataSets/Derived/Stena/QA/...` (reports, tables, figures mirror default structure).
      * Specifically includes overview, guardrails, missingness tables/notes, group counts, and SVG charts.
  - Command: `uv run python QA/port_turnaround_lookup_qa.py [--customer stena]`
    - Outputs: combined lookup summary SVG at `DataSets/Derived/NorthernLights/QA/figures/port_turnaround_lookup_summary.svg` (or `DataSets/Derived/Stena/QA/figures/...` when `--customer stena` is supplied).

Port turnaround ML prep
  - Command: `uv run python Models/train_port_turnaround_model.py [--customer stena] [--cutoff-date YYYY-MM-DD | --validation-ratio 0.2]`
    - Outputs: parquet splits + metadata in `DataSets/Derived/<customer>/ML/` (train/validation feature sets, feature manifest).
    - Notes: Default is a time cutoff of 2025-01-01. Provide `--validation-ratio` to split chronologically by fraction (sorted by voyage start date). Voyages without dates fall into the training set.

Port turnaround ML training
  - Command: `uv run python Models/fit_port_turnaround_model.py [--customer stena] [--model tree|hgbt] [--use-log-target] ...`
    - Outputs: model artefact under `Models/Artifacts/<customer>/`, metrics JSON (`..._metrics.json`), and QA report at `DataSets/Derived/<customer>/QA/ml/`.
    - Notes: Defaults mirror the decision-tree baseline; switch to `--model hgbt` for HistGradientBoosting with tunable `--learning-rate`, `--max-iter`, `--max-leaf-nodes`, etc.

Port turnaround ML visualisations
  - Command: `uv run python Models/plot_port_turnaround_model.py [--customer stena] [--split validation]`
    - Outputs: actual vs predicted scatter + residual histogram PNGs under `DataSets/Derived/<customer>/QA/ml/`.
    - Notes: Default split is validation; use `--split train` for training diagnostics.

General tips
  - Prefer `uv run <cmd>` so dependency resolution stays consistent across OSes.
  - If PowerShell blocks scripts, run `Set-ExecutionPolicy -Scope CurrentUser RemoteSigned` once.
  - Commit generated figures/text outputs to track data snapshots referenced in the thesis.
